# How to implement a new solver: to go further

(list-of-wrappers)=
## List of existing wrappers (gurobi, ortools, cpmpy, didppy, ...)

As shown above, when implementing a solver based on libraries already integrated in discrete-optimization, you can derive from
the corresponding wrappers defined in `discrete_optimization.generic_tools` to avoid redefining `solve()`. Generally
you will just have to implement
- `init_model()` that translates the problem in the other library language,
- `retrieve_solution()` or equivalent, in charge of translating solutions in d-o format.

Here is a curated list of the integrated libraries and corresponding wrappers:
- didppy (dynamic programming): `discrete_optimization.generic_tools.dyn_prog_tools.DpSolver`
- clingo (answer set programming): `discrete_optimization.generic_tools.asp_tools.AspClingoSolver`
- ortools/cpsat (contraint programming): `discrete_optimization.generic_tools.ortools_cpsat_tools.OrtoolsCpSatSolver`
- cpmpy (wrapping several constraint programming/mixed-integer linear programming solvers, with integrated explainablity tools):
  `discrete_optimization.generic_tools.cpmpy_tools.CpmpySolver`
- ortools/mathopt (wrapping several mixed-integer linear programming solvers): `discrete_optimization.generic_tools.lp_tools.OrtoolsMathOptMilpSolver`
- gurobi (mixed-integer linear programming): `discrete_optimization.generic_tools.lp_tools.GurobiMilpSolver`

Check implementations for existing problems to see them in action (e.g. solvers in `discrete_optimization.coloring.solvers`).

## Implementing the lexico API

When multiple objectives are defined for a given solver, you can implement some methods to enable lexico optimization.
For that you need to
- declare the solver compatible with the lexico API by overriding `implements_lexico_api()` so that it returns `True`,
- implement the following methods
  - `set_lexico_objective()`
  - `add_lexico_constraint()`
  - `get_lexico_objective_value()`
  - `remove_constraints()`

You can see an example of such an implementation with `discrete_optimization.rcpsp.solvers.cpsat.CpSatCumulativeResourceRcpspSolver`
and see it in action in the corresponding [tutorial on lexico meta-solver](../notebooks.md#lexicographic-optimization).

## Solvers for TasksProblem (scheduling/allocation)

If the problem you want to solve is deriving from TasksProblem or its child classes (mainly `SchedulingProblem` and `AllocationProblem`),
you should have soon access to an autogenerated cpsat solver (work in progress).

Meanwhile, if you implement a cpsat solver deriving
from `SchedulingCpsatSolver` or `AllocationCpsatSolver`, you will have access to a generic LNS (Large Neighborhood Search) solver.

See the [dedicated tutorial](../tasks_problem/tutorial_tasks_problem.md).
